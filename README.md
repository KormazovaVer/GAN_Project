# Генератор изображений в стиле Моне и Пикассо

Это приложение использует модели глубокого обучения для преобразования изображений в стили картин Клода Моне и
Пабло Пикассо.
Приложение позволяет загружать изображения и генерировать их версии в стиле знаменитых художников.

## Содержание

- [Описание](# описание)
- [Установка](# установка)
- [Использование](# использование)
- [Зависимости](# зависимости)


## Описание

Это приложение реализует цикл генерации изображений на основе GAN (Generative Adversarial Networks).
Реализована архитектура CycleGAN. Модель взята из статьи [https://arxiv.org/abs/1703.10593](# статья).
Она состоит из двух генераторов и двух дискриминаторов, которые обучаются на парах изображений:
картин Моне (Пикассо) и фотографий. После обучения пользователи могут загружать свои изображения и получать
их стилизованные версии. При необходимости модель может быть дообучена с последующим сохранением весов моделей.

### CycleGAN_models (model_monet, model_picasso)

Этот код реализует цикл обучения для модели генеративно-состязательной сети (GAN), которая предназначена
для преобразования фотографий в картины в стиле Клода Моне (Пабло Пикассо). Основные компоненты кода и 
архитектуры CycleGAN описаны ниже.

### Основные компоненты кода:

#### Импорт библиотек:
Используются библиотеки PyTorch для построения и обучения нейронных сетей, а также библиотеки для обработки
изображений и аугментации данных.

#### Загрузка данных:
Датасет картин Клода Моне и фотографий взят с kaggle https://www.kaggle.com/competitions/gan-getting-started/data.
Датасет картин Пабло Пикассо собран из открытых источников.

#### Определение классов:
ClaudeMonetDataset (PabloPicassoDataset): пользовательский класс, который наследует Dataset из PyTorch.
Он отвечает за загрузку изображений и их аугментацию.

#### Архитектура CycleGAN:
Дискриминатор:  
Состоит из нескольких сверточных слоев, которые последовательно уменьшают пространственное разрешение
изображения и увеличивают количество каналов. Использует Leaky ReLU в качестве функции активации и Instance
Normalization для стабилизации обучения.  
Генератор:  
Начинается с нескольких сверточных слоев, за которыми следуют остаточные блоки, помогающие сохранить информацию
о входном изображении. Затем используются транспонированные свертки для увеличения разрешения изображения до
исходного размера. В качестве активации используется функция tanh.

#### Обучение:
В функции train происходит обучение дискриминатора и генератора. Дискриминатор обучается отличать реальные
изображения от поддельных, а генератор обучается создавать изображения, которые будут классифицированы 
дискриминатором как реальные.
Потери:  
Используются различные функции потерь, включая:  
Adversarial Loss: для оценки качества сгенерированных изображений.  
Cycle Loss: для обеспечения сохранения информации о входном изображении в процессе преобразования.  
Identity Loss: для сохранения информации о входном изображении.  

#### Сохранение моделей:
Генераторы и дискриминаторы сохраняются в формате .pth, что позволяет их загружать для дальнейшего использования
или тестирования.

#### Оценка качества (ноутбуки на Google Colab):
Рассчитывается значение FID (Frechet Inception Distance) между реальными и сгенерированными изображениями,
что позволяет оценить качество генерации.

#### Тестирование модели (ноутбуки на Google Colab):
Функция test_model генерирует изображения в стиле Клода Моне (Пабло Пикассо) и фотографическом стиле на основе
загруженного изображения, а затем визуализирует оригинал и результаты генерации.

#### Заключение:
Данный код представляет собой реализацию генеративной состязательной сети (GAN) с использованием архитектуры
генератора, основанной на остаточных блоках и свёрточных слоях, а также стандартного дискриминатора. Генератор
отвечает за преобразование изображений, например, фотографий в стиль картин Моне (Пикассо), в то время как дискриминатор
обучается различать реальные и сгенерированные изображения. Обучение происходит итеративно: генератор и дискриминатор 
соревнуются друг с другом, что способствует улучшению качества сгенерированных изображений. Включение таких потерь,
как циклическая потеря и потеря идентичности, позволяет достичь более высокого уровня реалистичности в преобразовании
стиля.

#### Ссылки на ноутбуки Google Colab
1. https://colab.research.google.com/drive/1e1ESQPzyjYpx54sZNgPhanv-ou0w0I67?usp=sharing- модель Моне
2. https://colab.research.google.com/drive/1dFqQFnXM8jBz5FYcDrQRXrRWn2WMs0Rq?usp=sharing - модель Пикассо
3. https://colab.research.google.com/drive/11ULiskWRikLABU7E9-oVII-70FYQ3mun?usp=sharing - модель Моне с фильтром 
повышения резкости
4. https://colab.research.google.com/drive/1GQ3WwulJwZHEFj8GjSL-rrqXW5kQZ5Bv?usp=sharing - pre-trained CycleGAN model
(style_monet)

## Установка

1. Клонируйте репозиторий:

   ```bash
   git clone https://github.com/KormazovaVer/GAN_Project
   cd GAN_Project
   
2. Создайте виртуальное окружение (рекомендуется):

   ```bash
   python -m venv venv
   source venv/bin/activate  # Для Linux/Mac
   venv\Scripts\activate  # Для Windows
   
3. Установите зависимости:

   ```bash
   pip install -r requirements.txt
   
## Использование

1. Запустите приложение:

   ```bash
   streamlit run app.py
   
2. Откройте браузер и перейдите по адресу http://localhost:8501.

3. Загрузите изображение и нажмите кнопку "Сгенерировать изображение", чтобы получить стилизованные версии.

## Зависимости  
Python 3.x  
PyTorch  
Streamlit  
Albumentations  
tqdm  
Pillow  
Список всех зависимостей можно найти в файле requirements.txt.  
